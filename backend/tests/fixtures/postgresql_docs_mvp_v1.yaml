suite: postgresql_docs_mvp_v1
domain: postgresql_docs
description: >
  Starter regression suite for the PostgreSQL docs domain. Expand over time as you add
  more domains and harden evaluation expectations.
queries:
  - id: what_is_postgresql
    query: "What is PostgreSQL and what is it commonly used for?"
    tags: ["intro"]
    answerable_from_general_knowledge: true
    requires_docs: false
    expect:
      must_include_any:
        - ["PostgreSQL", "postgresql"]
        - ["database", "relational"]

  - id: create_table_basics
    query: "How do I create a table in PostgreSQL? Show a minimal example."
    tags: ["sql", "ddl"]
    answerable_from_general_knowledge: true
    requires_docs: false
    expect:
      must_include_any:
        - ["CREATE TABLE"]

  - id: primary_key
    query: "How do I define a primary key in PostgreSQL?"
    tags: ["sql", "ddl"]
    answerable_from_general_knowledge: true
    requires_docs: false
    expect:
      must_include_any:
        - ["PRIMARY KEY", "primary key"]

  - id: transactions_basics
    query: "What is a transaction in PostgreSQL and how do I use BEGIN/COMMIT?"
    tags: ["transactions"]
    answerable_from_general_knowledge: true
    requires_docs: false
    expect:
      must_include_any:
        - ["BEGIN", "START TRANSACTION"]
        - ["COMMIT", "ROLLBACK"]

  - id: create_index
    query: "How do I create an index in PostgreSQL and when would I use one?"
    tags: ["indexing"]
    answerable_from_general_knowledge: true
    requires_docs: false
    expect:
      must_include_any:
        - ["CREATE INDEX"]
        - ["index", "indexes"]

  - id: explain_analyze
    query: "How do I use EXPLAIN (ANALYZE) to understand query performance?"
    tags: ["performance"]
    answerable_from_general_knowledge: false
    requires_docs: true
    expect:
      must_include_any:
        - ["EXPLAIN"]
        - ["ANALYZE", "ANALYSE"]

  - id: vacuum_basics
    query: "What does VACUUM do in PostgreSQL?"
    tags: ["maintenance"]
    answerable_from_general_knowledge: false
    requires_docs: true
    expect:
      must_include_any:
        - ["VACUUM"]
        - ["dead tuple", "tuples", "space", "cleanup"]

  - id: jsonb_basics
    query: "What is JSONB in PostgreSQL and how is it different from JSON?"
    tags: ["json"]
    answerable_from_general_knowledge: true
    requires_docs: false
    expect:
      must_include_any:
        - ["JSONB", "jsonb"]
        - ["JSON", "json"]

  - id: psql_connect
    query: "How do I connect to a PostgreSQL database using psql? Give a minimal example."
    tags: ["psql"]
    answerable_from_general_knowledge: false
    requires_docs: true
    expect:
      must_include_any:
        - ["psql"]
        - ["-h", "-U", "-d", "host", "user", "database"]

  - id: create_index_concurrently
    query: "How do I create an index concurrently in PostgreSQL, and what is a key limitation?"
    tags: ["indexing", "performance"]
    answerable_from_general_knowledge: false
    requires_docs: true
    expect:
      must_include_any:
        - ["CREATE INDEX CONCURRENTLY"]
        - ["cannot run inside a transaction", "not in a transaction block", "outside a transaction"]

  - id: vacuum_full_lock
    query: "What does VACUUM FULL do, and what kind of lock does it require?"
    tags: ["maintenance", "edge_case"]
    answerable_from_general_knowledge: false
    requires_docs: true
    expect:
      must_include_any:
        - ["VACUUM FULL"]
        - ["exclusive", "AccessExclusiveLock", "access exclusive"]

  - id: identity_columns
    query: "How do I define an IDENTITY column in PostgreSQL? Show a minimal example."
    tags: ["sql", "ddl"]
    answerable_from_general_knowledge: false
    requires_docs: true
    expect:
      must_include_any:
        - ["GENERATED", "IDENTITY"]
        - ["BY DEFAULT", "ALWAYS"]

  - id: trap_builtin_sharding
    query: "Does PostgreSQL support sharding out of the box? Answer only if the PostgreSQL docs explicitly say so."
    tags: ["trap", "edge_case", "unsupported_claim"]
    answerable_from_general_knowledge: true
    requires_docs: false
    expected_abstain_in_docs: true
    expect:
      expect_idk: true

  - id: trap_capital_france
    query: "What is the capital of France? Answer only if the PostgreSQL docs explicitly say so."
    tags: ["trap", "edge_case", "unsupported_claim"]
    answerable_from_general_knowledge: true
    requires_docs: false
    expected_abstain_in_docs: true
    expect:
      expect_idk: true
